---
title: "Quantile Regression"
author: "Chris Cioffi, Kristina Frazier, Aidan Hennessy, Mike McHenry"
format: revealjs
editor: visual
---

## Quantile Regression

-   A useful alternative to Ordinary Least Squares (OLS).

-   Produces estimated regression coefficients for specific quantiles of the response variable.

    -   As a result, the coefficients will change as the specified quantile of the response variable changes.

## Sample Density

```{r}
# Load libraries
library(tidyverse)
library(quantreg)

set.seed(17)
# Generate random normal data
df_rnd <- as.tibble(rnorm(10000))

df_rnd |>
  ggplot(aes(value)) +
  geom_density() +
  geom_vline(xintercept = quantile(df_rnd$value, prob = 0.25), color = "red") +
  geom_vline(xintercept = quantile(df_rnd$value, prob = 0.50), color = "black") +
  geom_vline(xintercept = quantile(df_rnd$value, prob = 0.99), color = "blue") +
  labs(title = "Sample Density Plot",
       x = "",
       y = "") +
  theme_bw()
```

## Example of Linear and Quantile Trend Lines

```{r}
set.seed(16)
eps <- rnorm(100,0,2)
df_trends <- tibble(x = rnorm(100), y = 1.5*x + eps)

df_trends |>
  ggplot(aes(x, y)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  stat_quantile(quantiles = 0.15, color = "red", linetype = "dashed") +
  stat_quantile(quantiles = 0.85, color = "red", linetype = "dashed") +
  annotate(geom="text", x=2.1, y=2.5, label="Linear\nregression", color = "blue", size = 3.5) +
  annotate(geom="text", x=2.1, y=7, label="Quantile\nregression\nat 0.85", color = "red", size = 3.5) +
  annotate(geom="text", x=2.1, y=-1, label="Quantile\nregression\n at 0.15", color = "red", size = 3.5) +
  theme_bw()
```

## Why Use Quantile Regression?

-   The relationship between the predictor and response variables may vary across the distribution, making it useful to allow the estimates to change.

-   More robust to outliers.

-   If OLS assumptions are violated.

    -   Nonconstant variance, nonnormality, indpendence, nonlinearity.

## General Form of the Model

-   $Q_\tau(Y) = \beta_0(\tau) + \beta_1(\tau)X_1 + ... + \beta_p(\tau)X_p$

-   Where $\tau$ is a specific quantile value.

-   The objective of quantile regression is to minimize the median absolute deviations (Quantile Loss).

-   Rather than minimizing the sum of squares in OLS.

## Model Assumptions

-   Large sample size.

-   Response variable is continuous.

-   No strict distribution to adhere to.

## Quantreg

When you click the **Render** button a document will be generated that includes:

-   Content authored with markdown
-   Output from executable code

## References

https://www.voxco.com/blog/quantile-regression/
